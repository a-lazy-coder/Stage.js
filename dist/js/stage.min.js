Swag.registerHelpers(),_.each(["document","window"],function(e){window["$"+e]=$(window[e])}),Application=new Backbone.Marionette.Application,_.each(["Core","Util"],function(e){Application.module(e)}),window.onerror=function(e,t,n){window._lastResort=window._lastResort||[],window._lastResort.push({errorMsg:e,target:t,lineNum:n})},function(){Application.setup=function(e){function n(e,n){var r={h:$window.height(),w:$window.width()};Application.config.fullScreen&&t.height(r.h),n||Application.trigger("app:resized",r)}function r(){var e=$window.scrollTop();Application.trigger("app:scroll",e)}function s(e){e=_.compact(String(e).split("/"));if(e.length<=0)throw new Error("DEV::Application::Navigation path error");var t=e.shift();if(!t)throw new Error("DEV::Application::Empty context name...");var n=Application.Core.Context[t];if(!n)throw new Error("DEV::Application::You must have the required context "+t+" defined...");if(!Application.currentContext||Application.currentContext.name!==t){var r=new n,i;r.guard&&(i=r.guard());if(i){Application.trigger("app:context-guard-error",i,r.name);return}Application.currentContext&&Application.currentContext.trigger("context:navigate-away"),Application.Util.addMetaEvent(r,"context");var s=Application.config.navRegion||Application.config.contextRegion,o=Application.mainView.getRegion(s)||Application.getRegion(s);if(!o)throw new Error("DEV::Application::You don't have region '"+s+"' defined");o.show(r),Application.currentContext=r,Application.trigger("app:context-switched",Application.currentContext.name)}Application.currentContext.trigger("context:navigate-chain",e)}if(Application.config){_.extend(Application.config,e);return}Application.config=_.extend({theme:"default",template:"",contextRegion:"app",defaultContext:"Default",fullScreen:!1,rapidEventDebounce:200,baseAjaxURI:"/api",viewTemplates:"static/template"},e),Application.Util.addMetaEvent(Application,"app");var t=$("body");n(null,!0),$window.on("resize",_.debounce(n,Application.config.rapidEventDebounce)),$window.on("scroll",_.debounce(r,Application.config.rapidEventDebounce)),Application.config.fullScreen&&t.css({overflow:"hidden",margin:0,padding:0}),window.NProgress&&(Application.onAjaxStart=function(){NProgress.start()},Application.onAjaxStop=function(){NProgress.done()}),Application.onAjax=function(e){Application.config.baseAjaxURI&&(e.url=[Application.config.baseAjaxURI,e.url].join("/"));var t=e.xdomain;t&&(e.url=(t.protocol||"http")+"://"+(t.host||"localhost")+(t.port&&":"+t.port||"")+(/^\//.test(e.url)?e.url:"/"+e.url),e.crossDomain=!0,e.xhrFields=_.extend(e.xhrFields||{},{withCredentials:!0}),e.headers=_.extend(e.headers||{},t.headers))};var i=URI(window.location.toString()).search(!0).theme||Application.config.theme;return Application.Util.rollTheme(i),Application.config.viewTemplates&&Application.Util.Tpl.load(Application.config.viewTemplates+"/all.json"),Application.onNavigate=function(e,t){var n="";_.isString(e)?n=e:n=_.string.rtrim([e.context||Application.currentContext.name,e.module||e.subpath].join("/"),"/"),t?s(n):window.location.hash="navigate/"+n},Application.onContextGuardError=function(e,t){console.error("DEV:Context-Guard-Error:",t,e)},Application.on("initialize:after",function(e){var t=Backbone.Marionette.AppRouter.extend({appRoutes:{"navigate/*path":"navigateTo"},controller:{navigateTo:function(e){Application.trigger("app:navigate",e||Application.config.defaultContext,!0)}}});Application.router=new t,Backbone.history&&Backbone.history.start()}),Application},Application.run=function(e){function t(){window._lastResort&&_.each(window._lastResort,function(e){Application.trigger("app:error",e)}),window.onerror=function(e,t,n){Application.trigger("app:error",{errorMsg:e,target:t,lineNum:n})},Modernizr.mobile&&FastClick.attach(document.body),Application.addRegions({app:'[region="app"]'}),Application.trigger("app:before-template-ready"),Application.mainView=Application.view({type:"Layout",template:Application.config.template},!0),Application.getRegion("app").show(Application.mainView),Application.trigger("app:template-ready"),window.location.hash||(Application.Core.Context[Application.config.defaultContext]?window.location.hash=["#navigate",Application.config.defaultContext].join("/"):console.warn("DEV::Application::You might want to define a Default context using app.create('Context Name', {...})")),Application.start()}return e=e===!0?"deviceready":e,e?(Application.onError=function(e){console.error(e,e.target)},document.addEventListener(e,function(){$document.ready(t)},!1)):$document.ready(t),Application},Application.create=function(e,t){console.warn("DEV::Application::create() method is deprecated, use methods listed in Application._apis for alternatives")},_.extend(Application,{model:function(e){return new Backbone.Model(e)},collection:function(e){return new Backbone.Collection(e)},view:function(e,t){_.isBoolean(e)&&(t=e,e={});var n;if(!e.name){n=Backbone.Marionette[e.type||"ItemView"].extend(e);if(t)return new n}else n=Application.Core.Regional.create(e);return n},context:function(e,t){return _.isString(e)||(t=e,e=""),t=t||{},_.extend(t,{name:e}),Application.Core.Context.create(t)},regional:function(e,t){return _.isString(e)||(t=e,e=""),t=t||{},_.extend(t,{name:e}),t.name?Application.Core.Regional.create(t):(t.type=t.type||"Layout",Application.view(t,!0))},widget:function(e,t){if(_.isFunction(t)){Application.Core.Widget.register(e,t);return}return Application.Core.Widget.create(e,t)},editor:function(e,t){if(_.isFunction(t)){Application.Core.Editor.register(e,t);return}return Application.Core.Editor.create(e,t)}}),Application.editor.validator=Application.editor.rule=function(e,t){if(!_.isString(e))throw new Error("DEV::Application.editor.validator::You must specify a validator/rule name to use.");return Application.Core.Editor.addRule(e,t)},Application.page=Application.context,Application.area=Application.regional,Application.remote=function(e){return e.payload?Application.Core.Remote.change(e):Application.Core.Remote.get(e)},Application._apis=["model","collection","context - @alias:page","regional - @alias:area","view","widget","editor","editor.validator - @alias:editor.rule","remote","create - @deprecated"]}(),function(e){e.Util.addMetaEvent=function(e,t,n){n||(n=e),e.listenTo(e,"all",function(r){var i=String(r).split(":");if(i.length!==2||i[0]!==t)return;var s=_.string.camelize("on-"+i[1]);n[s]&&n[s].apply(e,_.toArray(arguments).slice(1))})}}(Application),function(e){var t=function(t){if(!t)return;$("#theme-roller").attr("href","themes/"+t+"/css/main.css"),e.currentTheme=t};e.Util.rollTheme=function(e){t(e)}}(Application),function(e){var t=function(e){var t=$("#hidden-download-iframe");t.length>0||($("body").append('<iframe id="hidden-download-iframe" style="display:none"></iframe>'),t=$("#hidden-download-iframe")),_.isString(e)&&(e={url:e}),t.attr("src",(new URI(e.url||"/")).search(_.omit(e,"url")).toString())};e.Util.download=t}(Application),function(e){var t={},n=/[\.\/]/,r={build:function(e,r){if(arguments.length===0||_.string.trim(e)==="")return{id:"#_blank",tpl:" "};if(arguments.length===1){if(_.string.startsWith(e,"#"))return{id:e};r=e,e=_.uniqueId("tpl-gen-"),_.isArray(r)||(r=[r])}e=String(e).split(n).join("-");if(t[e])throw new Error("DEV::APP.Util.Template::Conflict! You have already named a template with id:"+e);var i=_.isArray(r)?r.join(""):r;return $("head").append(['<script type="text/tpl" id="',e,'">',i,"</script>"].join("")),t[e]=!0,{id:"#"+e,string:i}},get:function(e){return e?(e=String(e).split(n).join("-"),t[e]?$("head").find("#"+e).html():!1):!1},list:function(){return _.keys(t)},load:function(t){$.ajax({url:t,dataType:"json",async:!1}).done(function(t){_.each(t,function(t,n){e.Util.Tpl.build(n,t)})})}};e.Util.Tpl=r}(Application),function(e,t,n){function i(n){if(!n)throw new Error("DEV::Core.Remote::options empty, you need to pass in at least a url string");if(t.isString(n))n={url:n,type:"GET"};else{t.extend(n,{type:undefined,data:undefined,processData:!1,contentType:"application/json; charset=UTF-8"});if(n.entity){var r=n.entity;n.url=r}n.payload&&n.payload._id&&(n._id&&console.warn("DEV::Core.Remote::options.payload._id",n.payload._id,"overriding options._id",n._id),n._id=n.payload._id);if(n._id||n._method){var i=new URI(n.url);n.url=i.path(t.compact([i.path(),n._id,n._method]).join("/")).toString()}n.params=n.querys||n.params,n.params&&(n.url=(new URI(n.url)).search(n.params).toString())}return e.trigger("app:ajax",n),n}function s(t){return t.done(function(t,n,r){e.trigger("app:success",{data:t,textStatus:n,jqXHR:r})}).fail(function(t,n,r){e.trigger("app:error",{errorThrown:r,textStatus:n,jqXHR:t})}),t}var r=e.module("Core.Remote");t.extend(r,{get:function(t){return t=i(t),t.type="GET",e.trigger("app:remote-pre-get",t),s(n.ajax(t))},change:function(r){r=i(r);if(!r.payload)throw new Error("DEV::Core.Remote::payload empty, please use GET");return r.payload._id&&t.size(r.payload)===1?r.type="DELETE":(t.isObject(r.payload)||(r.payload={payload:r.payload}),r.payload._id?r.type="PUT":r.type="POST"),r.type!=="DELETE"&&(r.data=JSON.stringify(r.payload)),e.trigger("app:remote-pre-change",r),s(n.ajax(r))}}),$document.ajaxStart(function(){e.trigger("app:ajax-start")}),$document.ajaxStop(function(){e.trigger("app:ajax-stop")})}(Application,_,jQuery),function(e){function t(t){t=_.string.classify(t);var n=e.module("Core."+t);_.extend(n,{map:{},has:function(e){if(!_.isString(e)||!e)throw new Error("DEV::Application.editor::You must specify the name of the "+t+" to look for.");return n.map[e]?!0:!1},register:function(e,r){if(!_.isString(e)||!e)throw new Error("DEV::Application.editor::You must specify a "+t+" name to register.");n.has(e)&&console.warn("DEV::Overriden::"+t+"."+e),n.map[e]=r()},create:function(e,r){if(!_.isString(e)||!e)throw new Error("DEV::Application.editor::You must specify the name of the "+t+" to create.");if(n.has(e))return new n.map[e](r);throw new Error("DEV::"+t+".Registry:: required definition ["+e+"] not found...")}})}t("Widget"),t("Editor")}(Application),function(e,t){var n=e.module("Core.Context");t.extend(n,{create:function(e){return t.extend(e,{name:e.name||"Default",className:"context context-"+t.string.slugify(e.name)+" "+(e.className||""),isContext:!0}),n[e.name]&&console.warn("DEV::Core.Context::You have overriden context '",e.name,"'"),n[e.name]=Backbone.Marionette.Layout.extend(e),n[e.name]}})}(Application,_),function(e,t,n){var r=e.module("Core.Regional"),i={};t.extend(r,{create:function(e){if(!e.name)throw new Error("DEV::Core.Regional::You must give this regional view a name...");return i[e.name]&&console.warn("DEV::Core.Regional::You have overriden regional view '",e.name,"'"),i[e.name]=n[e.type||"Layout"].extend(e),i[e.name]},get:function(e,t){var n=i[e];return t?new n(t):n}})}(Application,_,Marionette),function(e){Backbone.Marionette.TemplateCache.prototype.loadTemplate=function(t){if(_.string.startsWith(t,"#"))return $(t).html();if(_.string.startsWith(t,"@")){var n=e.Util.Tpl.get(t.substr(1));if(n)return n;$.ajax({url:e.config.viewTemplates+"/"+t.substr(1),async:!1}).done(function(e){n=e}).error(function(){n=!1});if(n)return e.Util.Tpl.build(t.substr(1),n).string;throw new Error("DEV::View Template::Can not load template..."+t+", re-check your app.config.viewTemplates setting")}return _.isArray(t)?t.join(""):t},Backbone.Marionette.TemplateCache.prototype.compileTemplate=function(e){return Handlebars.compile(e)}}(Application),function(e){_.extend(Backbone.Marionette.Region.prototype,{open:function(e){e.effect?(_.isString(e.effect)&&(e.effect={name:e.effect}),this.$el.hide(),this.$el.empty().append(e.el),this.$el.show(e.effect.name,e.effect.options,e.effect.duration||200)):this.$el.empty().append(e.el),this._parentLayout&&(e.parentCt=this._parentLayout,this._parentLayout.isContext?e.parentCtx=this._parentLayout:this._parentLayout.parentCtx&&(e.parentCtx=this._parentLayout.parentCtx)),e.fieldset&&(this._parentLayout._fieldsets=this._parentLayout._fieldsets||{},this._parentLayout._fieldsets[e.fieldset]=e)}})}(Application),function(e){_.extend(Backbone.Marionette.View.prototype,{enableActionTags:function(e,t){this.enableUILocks(),_.isBoolean(e)&&(t=e,e=""),t=t||!1,this.events=this.events||{},_.extend(this.events,{"click [action]":"_doAction"}),this.actions=this.actions||{},e=e||this.name||"UNKNOWN.View",this._doAction=function(n){if(this.isUILocked()){n.stopPropagation(),n.preventDefault();return}var r=$(n.currentTarget),i=r.attr("action")||"UNKNOWN",s=String(i).split(":");if(s.length>=2)return s.shift(),n.stopPropagation(),this.trigger(s.join(":"));var o=this.actions[i];if(!o){if(t)return;throw n.stopPropagation(),new Error("DEV::"+(e||"UI Component")+"::You have not yet implemented this action - ["+i+"]")}n.stopPropagation(),o.apply(this,[r,n])}}}),_.extend(Backbone.Marionette.View.prototype,{enableUILocks:function(){this._uilocks=_.reduce(this.regions,function(e,t,n,r){return e[n]=!1,e},{_all:!1}),this.lockUI=function(e,t){e=this._checkRegion(e),t=t||"_default_";if(!this._uilocks[e])return this._uilocks[e]=t,!0;if(this._uilocks[e]===t)return!0;throw new Error("DEV::View::UI Locks::This region "+e+" is already locked by "+this._uilocks[e])},this.unlockUI=function(e,t){e=this._checkRegion(e),t=t||"_default_";if(!this._uilocks[e])return!0;if(this._uilocks[e]===t)return this._uilocks[e]=!1,!0;throw new Error("DEV::View::UI Locks::This region "+e+" is locked by "+this._uilocks[e]+", you can NOT unlock it with "+t)},this.isUILocked=function(e){return e=this._checkRegion(e),this._uilocks[e]},this._checkRegion=function(e){if(!this._uilocks)throw new Error("DEV::View::You need to enableUILocks() before you can use this...");if(!e)e="_all";else if(!this.regions||!this.regions[e])throw new Error("DEV::View::UI Locks::This region does NOT exist - "+e);return e}}}),_.extend(Backbone.Marionette.View.prototype,{enableTooltips:function(e){this.listenTo(this,"render",function(){this.$('[data-toggle="tooltip"]').tooltip(e)})}}),Backbone.Marionette.View.prototype.constructor=function(t){return t=t||{},this.template=t.template||this.template||" ",this._ui=_.extend({},this.ui,t.ui),this.listenTo(this,"render",function(){var e=this;this.unbindUIElements(),this.ui=this._ui,$(this.el.outerHTML).find("[ui]").each(function(t,n){var r=$(this).attr("ui");e.ui[r]='[ui="'+r+'"]'}),this.bindUIElements()}),e.Util.addMetaEvent(this,"view"),this.actions&&this.enableActionTags(this.actions._bubble),this.editors&&this.activateEditors&&this.listenTo(this,"render",function(){this.activateEditors(this.editors)}),this.svg&&this.enableSVG&&this.listenTo(this,"render",this.enableSVG),this.tooltips&&this.enableTooltips(this.tooltips),this.overlay&&(this._overlayConfig=_.isBoolean(this.overlay)?{}:this.overlay,this.overlay=function(e){e=e||{};var t=$(e.anchor||"body"),n=this;return this.listenTo(this,"close",function(){t.overlay()}),this.render().trigger("view:show"),t.overlay(_.extend(this._overlayConfig,e,{content:this.el,onClose:function(){n.close()}})),this}),Backbone.Marionette.View.apply(this,arguments)}}(Application),function(e){_.extend(Backbone.Marionette.ItemView.prototype,{enableSVG:function(){if(!Raphael)throw new Error("DEV::View::You did NOT have Raphael.js included in the libs.");var e=this;Raphael(this.el,this.$el.width(),this.$el.height(),function(){e.paper=this,e.trigger("view:paper-ready",this)}),this.onFitPaper=function(){if(!this.paper)return;this.paper.setSize(this.$el.width(),this.$el.height()),this.trigger("view:paper-resized")}}}),_.extend(Backbone.Marionette.ItemView.prototype,{activateEditors:function(t){this._editors=this._editors||{};if(this._editors.attachView)throw new Error("DEV::ItemView::activateEditors enhancements will need this._editors object, it is now a Region!");var n=t._global||{};_.each(t,function(t,r){if(r.match(/^_./))return;var i,s;_.isFunction(t)?(i=t,t=_.extend({},n),s=new i,s.name=r,s.isCompound=!0):(t=_.extend({name:r,parentCt:this},n,t),t.label||(t.className=t.className||" "),t.type=t.type||"text",i=e.Core.Editor.map[t.type]||e.Core.Editor.map.Basic,s=new i(t)),this._editors[r]=s.render();var o=this.$('[editor="'+r+'"]');o.length===0&&t.appendTo&&(o=this.$(t.appendTo)),o.length===0&&(o=this.$el),o.append(s.el),t.value&&s.setVal(t.value)},this),this.listenTo(this,"before:close",function(){_.each(this._editors,function(e){e.close()})});var r=_.pick(this,"getEditor","getValues","setValues","validate","status");this.getEditor=function(e){return this._editors[e]||r.getEditor&&r.getEditor.call(this,e)},this.getValues=function(){var e=r.getValues&&r.getValues.call(this)||{};return _.each(this._editors,function(t,n){var r=t.getVal();r!==undefined&&r!==null&&(e[n]=r)}),e},this.setValues=function(e,t){if(!e)return;_.each(this._editors,function(n,r){e[r]&&n.setVal(e[r],t)}),r.setValues&&r.setValues.call(this,e,t)},this.validate=function(e){var t=r.validate&&r.validate.call(this,e)||{};_.each(this._editors,function(n,r){var i;this.isCompound?i=n.validate():i=n.validate(e),i&&(t[r]=i)},this),this.isCompound&&e&&this.status(t);if(_.size(t)===0)return;return t},this.status=function(e){if(_.isString(e))throw new Error("DEV::ItemView::activateEditors - You need to pass in messages object instead of "+e);r.status&&r.status.call(this,e);if(!e||_.isEmpty(e)){_.each(this._editors,function(e,t){e.status()});return}_.each(e,function(e,t){this._editors[t]&&this._editors[t].status(e)},this)}}}),_.extend(Backbone.Marionette.ItemView.prototype,{onRenderData:function(e){this.model||(this.model=new Backbone.Model,this.listenTo(this.model,"change",this.render)),this.model.set(e),this.trigger("view:data-rendered")}})}(Application),function(e){_.extend(Backbone.Marionette.Layout.prototype,{getValues:function(){var e={};return this.regionManager.each(function(t){t.currentView&&t.currentView.getValues&&(t.currentView.fieldset?e[t.currentView.fieldset]=t.currentView.getValues():_.extend(e,t.currentView.getValues()))}),e},setValues:function(e,t){this.regionManager.each(function(n){n.currentView&&n.currentView.setValues&&(n.currentView.fieldset?n.currentView.setValues(e[n.currentView.fieldset],t):n.currentView.setValues(e,t))})},validate:function(e){var t={};this.regionManager.each(function(n){n.currentView&&n.currentView.validate&&(n.currentView.fieldset?t[n.currentView.fieldset]=n.currentView.validate(e):_.extend(t,n.currentView.validate(e)))});if(_.size(t)===0)return;return t},getEditor:function(e){if(!e||_.isEmpty(e))return;_.isArray(e)||(e=String(e).split("."));var t=e.shift();if(this._fieldsets&&this._fieldsets[t])return this._fieldsets[t].getEditor(e.join("."));return},status:function(e){this.regionManager.each(function(t){t.currentView&&t.currentView.status&&(!e||!t.currentView.fieldset?t.currentView.status(e):t.currentView.status(e[t.currentView.fieldset]))})}});var t=Backbone.Marionette.Layout;Backbone.Marionette.Layout=t.extend({constructor:function(n){n=n||{},this.regions=_.extend({},this.regions,n.regions),this.listenTo(this,"render",function(){var e=this;$(this.el.outerHTML).find("[region]").each(function(t,n){var r=$(n).attr("region");e.regions[r]={selector:'[region="'+r+'"]'}}),this.addRegions(this.regions),_.each(this.regions,function(e,t){this[t].ensureEl(),this[t].$el.addClass("region region-"+_.string.slugify(t)),this[t]._parentLayout=this},this)}),this.listenTo(this,"show",function(){_.each(this.regions,function(t,n){this.debug&&this[n].$el.html('<p class="alert alert-info">Region <strong>'+n+"</strong></p>"),this[n].listenTo(this[n],"region:load-view",function(t,n){if(!t)return;if(e.Core.Widget.has(t)){this.show(e.Core.Widget.create(t,n));return}var r=e.Core.Regional.get(t);if(r){this.show(new r(n));return}if(_.string.startsWith(t,"@")){this.show(e.view({template:t,type:"Layout"},!0));return}console.warn("DEV::Layout::View required "+t+" can NOT be found...use app.create('Regional', {name: ..., ...}).")}),this[n].trigger("region:load-view",this[n].$el.attr("view"))},this)});if(n.name||this.name)this.navRegion=n.navRegion||this.navRegion,this.navRegion&&(this.onNavigateChain=function(t){if(!this.regions[this.navRegion]){console.warn("DEV::Layout::View","invalid navRegion",this.navRegion,"in",this.name||n.name);return}if(!t||t.length===0){this.trigger("view:navigation-end");return}var r=t.shift(),i=e.Core.Regional.get(r);if(!i)return t.unshift(r),this.trigger("view:navigate-to",t.join("/"));var s=this.getRegion(this.navRegion);if(!s.currentView||i.prototype.name!==s.currentView.name){var o=new i;s.show(o),o.trigger("view:navigate-chain",t);return}s.currentView.trigger("view:navigate-chain",t)});return t.prototype.constructor.call(this,n)}})}(Application),function(e){_.extend(Backbone.Marionette.View.prototype,{onRenderData:function(e){if(!_.isArray(e))throw new Error("DEV::CollectionView+::You need to have an array passed in as data...");this.collection||(this.collection=new Backbone.Collection,this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this.render)),this.collection.reset(e),this.trigger("view:data-rendered")},onLoadPage:function(t){t=_.extend({page:1,pageSize:15,dataKey:"payload",totalKey:"total",params:{}},this._remote,t),_.each(["params","querys"],function(e){if(!t[e])return;_.extend(t[e],{offset:(t.page-1)*t.pageSize,size:t.pageSize})});var n=this;this._remote=t,e.remote(_.omit(t,"page","pageSize","dataKey","totalKey")).done(function(){n.trigger("view:load-page-done",arguments)}).fail(function(){n.trigger("view:load-page-fail",arguments)}).always(function(){n.trigger("view:load-page-always",arguments)})},onLoadPageDone:function(e){var t=e[0];this.trigger("view:render-data",t[this._remote.dataKey]),this.trigger("view:page-changed",{current:this._remote.page,total:Math.ceil(t[this._remote.totalKey]/this._remote.pageSize)})}})}(Application);var I18N={};(function(e,t,n){function l(){o&&store.set(a,u)}function c(e){function r(e){n.push("## module: "),n.push(e),n.push(" ##"),n.push("\n")}function i(e,t){e=String(e),t=String(t),n.push('"'),n.push(e.replace(/"/g,'\\"')),n.push('"'),n.push("="),n.push(t),n.push("\n")}var n=[];t.each(u,function(n,s){if(e&&!n)return;typeof n=="object"?t.each(n,function(e,t){t!=="_default"&&r(t),i(s,e)}):i(s,n)});var s=n.join("");return s}function h(e){var n=u;return e&&(n=t.reject(u,function(e,t){return e?!0:!1})),JSON.stringify({locale:s,trans:n})}function p(t,n){var r=e(n),i=r.data("i18nKey"),s=r.data("i18nModule");i==="*"&&(i=e.trim(r.html())),r.html(i.i18n({module:s}))}var r={resourcePath:"static/resource",translationFile:"i18n.json"};I18N.configure=function(e){t.extend(r,e)};var i=n(window.location.toString()).search(!0),s=i.locale,o=i.localizer,u;if(s){e.ajax({url:[r.resourcePath,s,r.translationFile].join("/"),async:!1,success:function(e,t,n){u=e.trans},error:function(e,t,n){throw new Error("RUNTIME::i18n::"+n)}}),u=u||{};if(o){var a=["resources_",s].join(""),f=store.get(a);f&&t.each(f,function(e,n){if(!e)return;if(!u[n]){u[n]=e;return}t.isString(u[n])?u[n]=e:t.isObject(u[n])&&t.isObject(e)&&t.extend(u[n],e)})}}String.prototype.i18n=function(t){var n=e.trim(this);if(!s||!n)return n;var r=u[n];if(typeof r=="undefined")return u[n]="",l(),n;if(typeof r=="object"){var i=t&&t.module||"_default";r=r[i];if(typeof r=="undefined")return u[n][i]="",l(),n}return r=String(r),r.trim()===""?n:r},I18N.getResourceProperties=c,I18N.getResourceJSON=h,I18N.clearResourceCache=function(){var e=["resources_",s].join("");store.remove(e)},Handlebars&&Handlebars.registerHelper("i18n",function(e,t,n){return n||(n=t,t=undefined),String(e).i18n(t&&{module:t})}),e.fn.i18n=function(e){return e=t.extend({search:!1},e),e.search?(this.find("[data-i18n-key]").each(p),this):this.filter("[data-i18n-key]").each(p)}})(jQuery,_,URI),function(e){function t(e,t){var n=window.hljs;n&&(n.configure(t&&t.hljs),e.find("pre code").each(function(){n.highlightBlock(this)}))}e.fn.md=function(n){var r=this;return _.isString(n)&&(n={url:n}),n=n||{},this.each(function(r,i){var s=e(i),o=s.data(),u=n.url||o.url;e.get(u).done(function(e){var r;o.md&&o.md.data===e?r=o.md.content:(r=marked(e,n.marked),s.data("md",{data:e,content:r})),s.html(r).addClass("md-content"),t(s,n),n.cb&&n.cb(s)})})}}(jQuery),function(e){function r(n,r){r=_.extend({ignoreRoot:!1,headerHTML:""},r);var i=[],s=e("<div></div>").append(r.headerHTML).append("<ul></ul>");s.$children=s.find("> ul").data("children",[]);var o=s,u=r.ignoreRoot?1:0;n.find((r.ignoreRoot?"":"h1,")+"h2,h3,h4,h5,h6").each(function(){var n=e(this),r=n.context.localName,s=n.html(),a=n.attr("id");i.push(n);var f=e('<li><a href="#" data-id="'+a+'" action="goTo">'+s+"</a><ul></ul></li>");f.data({title:s,id:a});switch(r){case"h2":case"H2":f.addClass("chapter");break;case"h3":case"H3":f.addClass("section");break;default:}f.$children=f.find("> ul").data("children",[]);var l=t[r]-u;if(l>0)f.$parent=o,o.$children.append(f).data("children").push(f),u++;else if(l===0)f.$parent=o.$parent,o.$parent.$children.append(f).data("children").push(f);else{while(l<0)l++,o=o.$parent,u--;f.$parent=o.$parent,o.$parent.$children.append(f).data("children").push(f)}o=f,n.data("toc-node",f)}),n.data("toc",{html:'<div class="md-toc">'+s.html()+"</div>",$headers:i})}var t={};for(var n=1;n<=6;n++)t["h"+n]=t["H"+n]=n;e.fn.toc=function(t){return this.each(function(n,i){var s=e(i);r(s,t)})}}(jQuery),function(e){var t=Handlebars.compile(['<div class="overlay {{class}}" style="position:absolute; top: 0; left: 0; right: 0; bottom: 0; {{#unless class}}z-index:{{zIndex}};background:{{background}};{{/unless}}">','<div class="overlay-outer" style="display: table;table-layout: fixed; height: 100%; width: 100%;">','<div class="overlay-inner" style="display: table-cell;text-align: center;vertical-align: middle; width: 100%;">','<div class="overlay-content-ct" style="display: inline-block;outline: medium none; position:relative;">',"</div>","</div>","</div>","</div>"].join(""));e.fn.overlay=function(n,r){return _.isObject(n)&&(r=n,n=!0),_.isUndefined(n)&&(n=!1),r=r||{},this.each(function(i,s){var o=e(this),u;if(!n){if(!o.data("overlay"))return;u=o.data("overlay"),r=_.extend({},u.data("closeOptions"),r),u.hide({effect:r.closeEffect||r.effect||"clip",complete:function(){r.onClose&&r.onClose(o,u),$window.off("resize",u.data("onResize")),u.remove();var e=o.data("recover-css");o.css({overflowY:e.overflow.y,overflowX:e.overflow.x,position:e.position}),o.removeData("overlay","recover-css")}})}else{if(o.data("overlay"))return;r=_.extend({zIndex:100,background:r.content?"rgba(0, 0, 0, 0.7)":"none",move:!1,resize:!1},r),u=e(t(r)),o.data("recover-css",{overflow:{x:o.css("overflowX"),y:o.css("overflowY")},position:o.css("position")}),o.append(u).css({position:"relative",overflow:"hidden"}),o[0].tagName==="BODY"&&(u.offset({top:$window.scrollTop()}),u.height($window.height()),u.data("onResize",function(){u.height($window.height())}),$window.on("resize",u.data("onResize"))),u.hide(),o.data("overlay",u),$container=u.find(".overlay-content-ct"),r.resize&&$container.resizable({containment:"parent"}),r.move&&$container.draggable({containment:"parent"}),u.data({closeOptions:_.pick(r,"closeEffect","effect","duration","onClose"),container:$container}),u.data("container").html(_.isFunction(r.content)?r.content(o,u):r.content),u.show({effect:r.openEffect||r.effect||"clip",complete:function(){r.onShow&&r.onShow(o,u)}})}})}}(jQuery),function(e){e.Core.Editor.register("Basic",function(){var t=Backbone.Marionette.ItemView.extend({template:"#editor-basic-tpl",className:"form-group",events:{change:"_triggerEvent","keyup input, textarea":"_triggerEvent",focusout:"_triggerEvent",focusin:"_triggerEvent"},initialize:function(t){this.parentCt=t.parentCt;if(t.type in{select:!0,radios:!0,checkboxes:!0}){switch(t.type){case"radios":t.type="radio";break;case"checkboxes":t.type="checkbox";break;default:}t.options=t.options||{},t.options=_.extend({data:[],valueField:"value",labelField:"label"},t.options);var n=t.options,r=function(e){return _.isObject(e[0])?e=_.map(e,function(e){return{value:e[n.valueField],label:e[n.labelField]}}):e=_.map(e,function(e){return{value:e,label:_.string.titleize(e)}}),e},i=function(e){return _.isArray(e.data)||(e.grouped=!0),e.grouped?_.each(e.data,function(t,n){e.data[n]=r(t)}):e.data=r(e.data),e};n.remote?this.listenToOnce(this,"render",function(){var t=this;e.remote(n.remote).done(function(e){t.setChoices(e)})}):i(t.options),this.setChoices=function(e){var t=this.model.get("options");t.data=e,this.model.set("options",i(t)),this.render()}}var s=_.uniqueId("basic-editor-");this.model=new Backbone.Model({uiId:s,layout:t.layout||"",name:t.name,type:t.type,multiple:t.multiple||!1,rows:t.rows||3,fieldname:t.fieldname||s,label:t.label||"",placeholder:t.placeholder||"",help:t.help||"",tooltip:_.isString(t.tooltip)&&t.tooltip||"",options:t.options||undefined,boxLabel:t.boxLabel||"",value:t.value,checked:t.checked||!0,unchecked:t.unchecked||!1}),t.validate&&(this.validators=_.map(t.validate,function(e,t){return _.isFunction(e)?{fn:e}:{rule:t,options:e}}),this.validate=function(n){if(!this.isEnabled())return;var r;if(_.isFunction(t.validate))r=t.validate(this.getVal(),this.parentCt);else{var i=_.clone(this.validators);while(i.length>0){var s=i.shift();s.fn?r=s.fn(this.getVal(),this.parentCt):r=e.Core.Editor.rules[s.rule]&&e.Core.Editor.rules[s.rule](s.options,this.getVal(),this.parentCt);if(!_.isEmpty(r))break}}return n&&this._followup(r),r},this._followup=function(e){_.isEmpty(e)?(this.status(),this.eagerValidation=!1):(this.status(e),this.eagerValidation=!0)},this.listenTo(this,"editor:change editor:keyup",function(){this.eagerValidation&&this.validate(!0)})),t.tooltip&&this.enableTooltips(_.isObject(t.tooltip)?t.tooltip:{});if(t.type==="file"){this.enableActionTags("Editor.File");if(!t.upload||!t.upload.url)throw new Error("DEV::Editor.Basic.File::You need options.upload.url to point to where to upload the file.");this.listenTo(this,"editor:change",function(){this.ui.input.val()?(t.upload.standalone&&this.ui.upload.removeClass("hide").show(),this.ui.clearfile.removeClass("hide").show()):(this.ui.upload.hide(),this.ui.clearfile.hide())}),this.onRender=function(){this.$el.fileupload({fileInput:null}),t.upload.callbacks&&_.each(t.upload.callbacks,function(e,t){this.$el.bind("fileupload"+t,e)},this)},_.extend(this.actions,{clear:function(){this.setVal("",!0)},upload:function(){this.upload(t.upload)}}),this.upload=function(n){_.isFunction(n.formData)&&(n.formData=n.formData()),e.config.baseAjaxURI&&(n.url=[e.config.baseAjaxURI,n.url].join("/")),this.$el.fileupload("send",_.extend({fileInput:this.ui.input},t.upload,n))}}},isEnabled:function(){return!this._inactive},disable:function(e){e===!1?this._inactive=!1:this._inactive=!0;if(_.isUndefined(e)){this.ui.input.prop("disabled",!0);return}e?this.$el.hide():(this.ui.input.prop("disabled",!1),this.$el.show())},setVal:function(e,t){this.ui.inputs?this.ui.inputs.find("input").val(_.isArray(e)?e:[e]):this.ui["input-ro"]?(e=_.escape(e),this.ui["input-ro"].data("value",e).html(e)):(this.model.get("type")==="checkbox"&&this.ui.input.prop("checked",e===this.model.get("checked")),this.ui.input.val(e)),t&&this._triggerEvent({type:"change"})},getVal:function(){if(!this.isEnabled())return;if(this.ui.inputs){var e=this.$("input:checked").map(function(e,t){return $(this).val()}).get();return this.model.get("type")==="radio"&&(e=e.pop()),e}if(this.model.get("type")==="checkbox")return this.ui.input.prop("checked")?this.model.get("checked")||!0:this.model.get("unchecked")||!1;if(this.ui.input)return this.ui.input.val()},validate:$.noop,status:function(e){if(e){var t="error",n=e;_.isString(e)||(t=e.type||t,n=e.msg||t);var r="has-"+t;this.$el.removeClass(this.$el.data("type-class")).addClass(r).data("type-class",r),this.ui.msg.html(n)}else this.$el.removeClass(this.$el.data("type-class")).removeData("type-class"),this.ui.msg.empty()},_triggerEvent:function(e){var t=this;t.trigger("editor:"+e.type,this.model.get("name"),this),this.parentCt&&(t=this.parentCt),t.trigger("editor:"+e.type,this.model.get("name"),this)}});return t}),e.Util.Tpl.build("editor-basic-tpl",["{{#if label}}",'<label class="control-label {{#if layout}}{{layout.label}}{{/if}}" for="{{uiId}}">{{label}}</label>',"{{/if}}",'<div class="{{#if layout}}{{layout.field}}{{/if}}" data-toggle="tooltip" title="{{tooltip}}">','{{#is type "select"}}','<select ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" class="form-control" id="{{uiId}}" {{#if multiple}}multiple="multiple"{{/if}} style="margin-bottom:0">',"{{#if options.grouped}}","{{#each options.data}}",'<optgroup label="{{@key}}">',"{{#each this}}",'<option value="{{value}}">{{label}}</option>',"{{/each}}","</optgroup>","{{/each}}","{{else}}","{{#each options.data}}",'<option value="{{value}}">{{label}}</option>',"{{/each}}","{{/if}}","</select>","{{else}}",'{{#is type "textarea"}}','<textarea ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" class="form-control" id="{{uiId}}" rows="{{rows}}" placeholder="{{placeholder}}" style="margin-bottom:0"></textarea>',"{{else}}","{{#if options}}",'<div ui="inputs" id={{uiId}}>',"{{#each options.data}}",'{{#unless ../options.inline}}<div class="{{../../type}}">{{/unless}}','<label class="{{#if ../options.inline}}{{../../type}}-inline{{/if}}">','<input ui="input" name="{{#if ../fieldname}}{{../../fieldname}}{{else}}{{../../name}}{{/if}}{{#is ../type "checkbox"}}[]{{/is}}" type="{{../type}}" value={{value}}> {{label}}',"</label>","{{#unless ../options.inline}}</div>{{/unless}}","{{/each}}","</div>","{{else}}",'<div class="{{type}}">','{{#is type "checkbox"}}',"<label>",'<input ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" type="checkbox" value="{{value}}"> {{boxLabel}}',"</label>","{{else}}",'{{#is type "ro"}}','<div ui="input-ro" data-value="{{{value}}}" class="form-control-static">{{{value}}}</div>',"{{else}}",'<input ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" {{#isnt type "file"}}class="form-control"{{else}} style="display:inline;" {{/isnt}} type="{{type}}" id="{{uiId}}" placeholder="{{placeholder}}" value="{{value}}"> <!--1 space-->','{{#is type "file"}}','<span action="upload" class="hide file-upload-action-trigger" ui="upload" style="cursor:pointer;"><i class="glyphicon glyphicon-upload"></i> <!--1 space--></span>','<span action="clear" class="hide file-upload-action-trigger" ui="clearfile"  style="cursor:pointer;"><i class="glyphicon glyphicon-remove-circle"></i></span>','<span ui="result" class="file-upload-result"></span>',"{{/is}}","{{/is}}","{{/is}}","</div>","{{/if}}","{{/is}}","{{/is}}",'{{#if help}}<span class="help-block editor-help-text" style="margin-bottom:0"><small>{{help}}</small></span>{{/if}}','<span class="help-block editor-status-text input-error" ui="msg">{{msg}}</span>',"</div>"])}(Application),function(e){e.Core.Editor.rules={required:function(e,t,n){if(!t)return _.isObject(e)&&e.msg||"This field is required"}},e.Core.Editor.addRule=function(t,n){if(!t||!_.isFunction(n))throw new Error("DEV::Editor::Basic validation rule must have a name and a function implementation.");e.Core.Editor.rules[t]&&console.warn("DEV::Editor::Basic validation rule name ["+t+"] is already defined."),e.Core.Editor.rules[t]=n}}(Application),function(e){e.widget("Datagrid",function(){var t=e.view({type:"Layout",tagName:"table",template:['<thead region="header"></thead>','<tbody region="body"></tbody>'],initialize:function(e){this._options=_.extend({data:[],details:!1,columns:[]},e)},onShow:function(){this.header.show(new n),this.body.show(new i({el:this.body.$el})),this.trigger("view:reconfigure",this._options)},onReconfigure:function(e){e=e||{},this._options.data=e.data||this._options.data,_.each(e.columns,function(e){},this),_.each(this._options.columns,function(e){e.header=e.header||"string",e.cell=e.cell||e.header||"string",e.label=e.label||_.string.titleize(e.name)}),this.header.currentView.trigger("view:render-data",this._options.columns),this.body.currentView._options=this._options,this.body.currentView.trigger("view:render-data",this._options.data)},onRenderData:function(e){this.trigger("view:reconfigure",{data:e})}}),n=e.view({type:"CollectionView",itemView:"dynamic",itemViewEventPrefix:"headercell",tagName:"tr",buildItemView:function(t,n,r){return e.widget(_.string.classify([t.get("header"),"header","cell"].join("-")),{model:t,tagName:"th"})}}),r=e.view({type:"CollectionView",itemView:"dynamic",itemViewEventPrefix:"cell",tagName:"tr",triggers:{click:{event:"clicked",preventDefault:!1},dblclick:{event:"dblclicked",preventDefault:!1}},initialize:function(e){this.grid=e.body.parentCt},buildItemView:function(t,n,r){return e.widget(_.string.classify([t.get("cell"),"cell"].join("-")),{tagName:"td",model:t,row:this})}}),i=e.view({type:"CollectionView",itemView:r,itemViewEventPrefix:"row",itemViewOptions:function(t,n){return{collection:e.collection(_.map(this._options.columns,function(e){return _.extend({value:selectn(e.name||"",t.attributes),index:n},e)},this)),body:this}},itemEvents:{clicked:function(e,t){t.grid.trigger("row:clicked",t)},dblclicked:function(e,t){t.grid.trigger("row:dblclicked",t)}}});return t})}(Application),function(e){e.widget("StringHeaderCell",function(){var t=e.view({template:'<span><i class="{{icon}}"></i> {{{label}}}</span>'});return t})}(Application),function(e){e.widget("StringCell",function(){var t=e.view({template:"<span>{{{value}}}</span>"});return t})}(Application),function(e){e.widget("SeqCell",function(){var t=e.view({template:"{{index}}"});return t})}(Application),function(e){e.widget("ActionCell",function(){var t=e.view({template:["{{#each actions}}",'<span class="action-cell-item" action="{{@key}}" data-toggle="tooltip" title="{{tooltip}}"><i class="{{icon}}"></i> {{label}}</span> ',"{{/each}}"],className:"action-cell",initialize:function(e){this.row=e.row;var t=this.model.get("actions")||{};_.each({preview:{icon:"fa fa-eye",tooltip:"Preview"},edit:{icon:"fa fa-pencil",tooltip:"Edit"},"delete":{icon:"fa fa-times",tooltip:"Delete"}},function(e,n){t[n]&&(t[n]=_.extend(e,t[n]))}),this.actions=this.actions||{},_.each(t,function(e,t){e.fn&&(this.actions[t]=function(t){e.fn.apply(this.row,arguments)})},this),this.model.set("actions",t),this.enableActionTags(!0)},tooltips:!0});return t})}(Application),function(e){e.widget("Tree",function(){var t={type:"CompositeView",tagName:"li",itemViewContainer:"ul",itemViewOptions:function(){return{parent:this}},className:function(){return _.size(this.model.get("children"))>=1?"node":"leaf"},initialize:function(t){this.parent=t.parent,this.className()==="node"&&(this.collection=e.collection(this.model.get("children"))),this.listenTo(this,"render",function(){this.$el.addClass("clickable").data({view:this,$children:this.$el.find("> ul"),$parent:this.parent&&this.parent.$el})})},template:['<a class="item" href="#"><i class="type-indicator"></i> <i class="{{icon}}"></i> {{{val}}}</a>','<ul class="children hidden"></ul>']},n=e.view({type:"CollectionView",className:"tree tree-root",tagName:"ul",initialize:function(n){this._options=n,this.itemView=this._options.itemView||e.view(_.extend({},t,_.omit(this._options.node,"type","tagName","itemViewContainer","itemViewOptions","className","initialize"))),this.onSelected=n.onSelected||this.onSelected},onShow:function(){this.trigger("view:reconfigure",this._options)},onReconfigure:function(e){_.extend(this._options,e),this.trigger("view:render-data",this._options.data)},events:{"click .clickable":function(e){e.stopPropagation();var t=$(e.currentTarget),n=t.data();t.hasClass("node")&&this.trigger("view:toggleChildren",n),this.trigger("view:selected",t.data(),t,e)}},onToggleChildren:function(e){e.$children.toggleClass("hidden"),e.view.$el.toggleClass("expanded")},onSelected:function(e,t,n){}});return n})}(Application),function(e){e.widget("Paginator",function(){var t=e.view({className:"pagination",tagName:"ul",template:['<li {{#if atFirstPage}}class="disabled"{{/if}}><a href="#" action="goToAdjacentPage" data-page="-">&laquo;</a></li>',"{{#each pages}}",'<li {{#if isCurrent}}class="active"{{/if}}><a href="#" action="goToPage" data-page="{{number}}">{{number}} <span class="sr-only">(current)</span></a></li>',"{{/each}}",'<li {{#if atLastPage}}class="disabled"{{/if}}><a href="#" action="goToAdjacentPage" data-page="+">&raquo;</a></li>'],initialize:function(e){this._options=e||{},e.target&&this.listenTo(e.target,"view:page-changed",function(e){this.trigger("view:reconfigure",{currentPage:e.current,totalPages:e.total})})},onShow:function(){},onReconfigure:function(e){_.extend(this._options,e);var t={atFirstPage:this._options.currentPage===1,atLastPage:this._options.currentPage===this._options.totalPages,pages:_.map(_.range(1,this._options.totalPages+1),function(e){return{number:e,isCurrent:e===this._options.currentPage}},this)};this.trigger("view:render-data",t)},actions:{goToPage:function(e,t){t.preventDefault();var n=e.data("page");if(n===this._options.currentPage)return;this.trigger("view:change-page",n)},goToAdjacentPage:function(e,t){t.preventDefault();var n=this._options.currentPage,r=e.data("page");r==="+"?n++:n--;if(n<1||n>this._options.totalPages)return;this.trigger("view:change-page",n)}},onChangePage:function(e){this._options.target&&this._options.target.trigger("view:load-page",{page:e})}});return t})}(Application);